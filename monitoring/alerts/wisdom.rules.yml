groups:
  - name: nova_wisdom_alerts
    interval: 30s
    rules:
      - alert: NovaWisdomHopfBifurcationNear
        expr: nova_wisdom_hopf_distance < 0.1
        for: 2m
        labels:
          severity: warning
          component: wisdom_governor
        annotations:
          summary: "Wisdom governor approaching Hopf bifurcation"
          description: >
            Hopf distance H = {{ $value }} < 0.1 for 2+ minutes.
            System may enter oscillatory instability.
            Current eta: {{ with query "nova_wisdom_eta_current" }}{{ . | first | value }}{{ end }}.
            Stability margin S: {{ with query "nova_wisdom_stability_margin" }}{{ . | first | value }}{{ end }}.
            Review gain parameters (KP/KD) or external perturbations.

      - alert: NovaWisdomHopfBifurcationCritical
        expr: nova_wisdom_hopf_distance < 0.05
        for: 1m
        labels:
          severity: critical
          component: wisdom_governor
        annotations:
          summary: "Wisdom governor entering oscillatory regime"
          description: >
            Hopf distance H = {{ $value }} < 0.05 — CRITICAL.
            Bifurcation imminent. Oscillations expected.
            Current eta: {{ with query "nova_wisdom_eta_current" }}{{ . | first | value }}{{ end }}.
            Immediately review stability or freeze learning.

      - alert: NovaWisdomEtaClampedLong
        expr: avg_over_time((nova_wisdom_eta_current <= 0.051)[5m:]) > 0.9
        for: 5m
        labels:
          severity: warning
          component: wisdom_governor
        annotations:
          summary: "Learning rate clamped at minimum for 5+ minutes"
          description: >
            η has been ≤ 0.051 for {{ $value | humanizePercentage }} of the last 5 minutes.
            System may be stuck in low-learning regime.
            Stability margin S: {{ with query "nova_wisdom_stability_margin" }}{{ . | first | value }}{{ end }}.
            Check if external stability perturbations justify clamp or if gains need tuning.

      - alert: NovaWisdomStabilityMarginLow
        expr: nova_wisdom_stability_margin < 0.01
        for: 3m
        labels:
          severity: critical
          component: wisdom_governor
        annotations:
          summary: "Stability margin critically low"
          description: >
            Stability margin S = {{ $value }} < 0.01 for 3+ minutes.
            System near saddle-node or transcritical bifurcation.
            Current eta: {{ with query "nova_wisdom_eta_current" }}{{ . | first | value }}{{ end }}.
            Spectral radius ρ: {{ with query "nova_wisdom_spectral_radius" }}{{ . | first | value }}{{ end }}.
            Reduce learning rate or freeze to prevent collapse.

      - alert: NovaWisdomSpectralRadiusHigh
        expr: nova_wisdom_spectral_radius > 0.95
        for: 2m
        labels:
          severity: warning
          component: wisdom_governor
        annotations:
          summary: "Spectral radius approaching instability boundary"
          description: >
            Spectral radius ρ = {{ $value }} > 0.95.
            System stability margin eroding.
            Current eta: {{ with query "nova_wisdom_eta_current" }}{{ . | first | value }}{{ end }}.
            Stability margin S: {{ with query "nova_wisdom_stability_margin" }}{{ . | first | value }}{{ end }}.
            Monitor for bifurcation or reduce learning aggression.

      - alert: NovaWisdomGammaCollapse
        expr: nova_wisdom_gamma < 0.3
        for: 5m
        labels:
          severity: warning
          component: wisdom_governor
        annotations:
          summary: "Wisdom level γ collapsed below 0.3"
          description: >
            Wisdom γ = {{ $value }} < 0.3 for 5+ minutes.
            Learning effectiveness severely degraded.
            Check for sustained errors or coherence loss in TRI.

      - alert: NovaWisdomLowGenerativity
        expr: avg_over_time(nova_wisdom_generativity[10m]) < 0.4
        for: 10m
        labels:
          severity: info
          component: wisdom_governor
        annotations:
          summary: "Low generativity score"
          description: >
            G* under 0.4 for 10+ minutes.
            System creativity/novelty degraded.
            Progress: {{ with query "nova_wisdom_generativity_components{component=\"progress\"}" }}{{ . | first | value }}{{ end }}.
            Novelty: {{ with query "nova_wisdom_generativity_components{component=\"novelty\"}" }}{{ . | first | value }}{{ end }}.
            Consistency: {{ with query "nova_wisdom_generativity_components{component=\"consistency\"}" }}{{ . | first | value }}{{ end }}.
            η may need manual guidance or parameter tuning.

      - alert: NovaWisdomHighBias
        expr: abs(avg_over_time(nova_wisdom_eta_bias_from_generativity[5m])) > 0.015
        for: 5m
        labels:
          severity: warning
          component: wisdom_governor
        annotations:
          summary: "Large η bias from generativity"
          description: >
            Controller bias |Δη| = {{ $value }} > 0.015 for 5+ minutes.
            Controller relies heavily on generativity feedback.
            Current G*: {{ with query "nova_wisdom_generativity" }}{{ . | first | value }}{{ end }}.
            Stability margin S: {{ with query "nova_wisdom_stability_margin" }}{{ . | first | value }}{{ end }}.
            Hopf distance H: {{ with query "nova_wisdom_hopf_distance" }}{{ . | first | value }}{{ end }}.
            Check S/H gating and TRI cap effectiveness.
